# Problem Statistics Generation

## Overview

The `PROBLEM_STATISTICS.md` file is automatically generated by scanning all question JSON files and counting problems by category, topic, subtopic, and difficulty level.

## Manual Generation

To generate or update the statistics file, run:

```bash
npm run generate-stats
```

This will:
1. Scan all JSON files in `public/content/questions/`
2. Count problems by topic, subtopic, and difficulty
3. Generate `docs/PROBLEM_STATISTICS.md` with a comprehensive breakdown

## Automatic Updates

There are several ways to automatically update the statistics file:

### Option 1: Git Pre-Commit Hook (Recommended)

Automatically update statistics before each commit:

1. Create `.git/hooks/pre-commit` (or copy from `.git/hooks/pre-commit.sample`)
2. Add the following content:

```bash
#!/bin/sh
# Update problem statistics before committing
npm run generate-stats
git add docs/PROBLEM_STATISTICS.md
```

3. Make it executable:
   ```bash
   chmod +x .git/hooks/pre-commit
   ```

**Note:** This requires the script to be run every commit, which might slow down commits slightly.

### Option 2: Add to Build Process

Update the build script to generate stats automatically:

In `package.json`, update the build script:

```json
{
  "scripts": {
    "build": "npm run generate-stats && tsc -b && vite build"
  }
}
```

This ensures stats are always up-to-date in production builds.

### Option 3: GitHub Actions (Recommended for CI/CD)

Add a step to your GitHub Actions workflow to verify stats are up-to-date:

In `.github/workflows/deploy-pages.yml`, add before the build step:

```yaml
- name: Generate and verify statistics
  run: |
    npm run generate-stats
    git diff --exit-code docs/PROBLEM_STATISTICS.md || (echo "⚠️  Statistics file is outdated. Run 'npm run generate-stats' and commit the changes." && exit 1)
```

This will fail the build if the stats file is outdated, reminding you to update it.

### Option 4: Manual Reminder

Set a reminder to run the script whenever you add new questions. You can also add a comment in the question creation guide to remind yourself.

## What Gets Counted

The script counts:
- **Total problems** across all files
- **Problems by topic** (e.g., Algebra, Geometry)
- **Problems by subtopic** (e.g., Linear Equations, Triangles)
- **Problems by difficulty** (1-5 stars)
- **Problems by file** (to see which files have the most questions)

## File Structure

- **Script:** `scripts/generate-stats.js`
- **Output:** `docs/PROBLEM_STATISTICS.md`
- **Source:** `public/content/questions/*.json`

## Troubleshooting

### Script fails with "Cannot find module"
- Make sure you're running from the project root
- Ensure Node.js is installed

### Statistics don't match
- Run `npm run generate-stats` to regenerate
- Check that all question JSON files are valid JSON
- Verify questions have `topic`, `subtopic`, and `diff` fields

### File not updating
- Check file permissions
- Ensure `docs/` directory exists
- Check console output for error messages

## Best Practice

**Recommended approach:** Use Option 3 (GitHub Actions) to verify stats are current, and manually run the script when adding questions. This:
- Keeps the file current
- Doesn't slow down every commit
- Fails builds if you forget to update stats
- Gives you control over when to update

## Example Workflow

1. Add new questions to a JSON file
2. Test the questions locally
3. Run `npm run generate-stats` to update statistics
4. Review the updated `PROBLEM_STATISTICS.md`
5. Commit both the new questions and updated stats file

